{"createdTime":"2024-04-23T19:19:28.522+00:00","createdBy":"daniel.qu","updatedTime":"2024-04-24T00:07:55.813+00:00","updatedBy":"daniel.qu","owner":{"teamName":"MS Runtime Fabric","ownerId":3109,"email":"runtime-fabric-team@mulesoft.com"},"testSteps":[{"testStepId":162305,"stepType":"API","stepNumber":1,"timeout":60,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Login to Anypoint Platform","testUrl":"<replaceable.baseurl>/accounts/login","expectedResponseCode":200,"section":"init","tracing":"NEW_128_BIT","conditionAction":"NONE","httpMethod":"POST","postContent":"{\"username\":\"<replaceable.username>\",\"password\":\"<secret.password>\"}","dependentResponseJsonData":{"access_token":"<TOKEN>"}},{"testStepId":162306,"stepType":"API","stepNumber":2,"timeout":60,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Query app version from Exchange","testUrl":"<replaceable.baseurl>/exchange/api/v1/assets","expectedResponseCode":200,"section":"core","tracing":"REUSE","conditionAction":"NONE","httpMethod":"GET","queryParams":{"search":"<replaceable.appid>","type":"app"},"headers":{"Authorization":"bearer <TOKEN>"},"dependentResponseJsonData":{"[0].version":"<APPVERSION>"}},{"testStepId":162307,"stepType":"API","stepNumber":3,"timeout":60,"softFailureEnabled":false,"retryOnFailure":false,"retryTest":false,"description":"Deploy an application","javaScript":{"pre":"function executeBeforeStep(currentStep) {\n    var suffix = Date.now();\n    testCase.setVariable(\"<suffix>\", suffix);\n}"},"testUrl":"<replaceable.baseurl>/amc/adam/api/organizations/<replaceable.orgid>/environments/<replaceable.envid>/deployments","expectedResponseCode":202,"section":"core","tracing":"REUSE","conditionAction":"NONE","httpMethod":"POST","headers":{"Authorization":"bearer <TOKEN>"},"postContent":"{\n    \"name\": \"<replaceable.appname>-<suffix>\",\n    \"labels\": [\n        \"beta\"\n    ],\n    \"target\": {\n        \"provider\": \"MC\",\n        \"targetId\": \"<replaceable.targetid>\",\n        \"deploymentSettings\": {\n            \"clustered\": false,\n            \"enforceDeployingReplicasAcrossNodes\": false,\n            \"http\":\n            {\n                \"inbound\":\n                {\n                    \"publicUrl\": \"<replaceable.urlprotocol>://<replaceable.domainname>/<replaceable.appname>-<suffix><replaceable.urlappendix>\",\n                    \"pathRewrite\": null\n                }\n            },\n            \"jvm\": {},\n            \"runtimeVersion\": \"<replaceable.runtimeversion>\",\n            \"updateStrategy\": \"rolling\",\n            \"resources\":\n            {\n                \"cpu\":\n                {\n                    \"reserved\": \"100m\",\n                    \"limit\": \"800m\"\n                },\n                \"memory\":\n                {\n                    \"reserved\": \"700Mi\",\n                    \"limit\": \"1500Mi\"\n                }\n            },\n            \"disableAmLogForwarding\": false,\n            \"persistentObjectStore\": false,\n            \"generateDefaultPublicUrl\": false\n        },\n        \"replicas\": 1\n    },\n    \"application\": {\n        \"ref\": {\n            \"groupId\": \"<replaceable.orgid>\",\n            \"artifactId\": \"<replaceable.appid>\",\n            \"version\": \"<APPVERSION>\",\n            \"packaging\": \"jar\"\n        },\n        \"assets\": [],\n        \"desiredState\": \"STARTED\",\n        \"configuration\": {\n            \"mule.agent.application.properties.service\": {\n                \"applicationName\": \"<replaceable.appname>-<suffix>\",\n                \"properties\": {},\n                \"secureProperties\": {}\n            },\n            \"mule.agent.logging.service\": {\n                \"artifactName\": \"<replaceable.appname>-<suffix>\",\n                \"scopeLoggingConfigurations\": []\n            }\n        },\n        \"integrations\": {\n            \"services\": {\n                \"objectStoreV2\": {\n                    \"enabled\": false\n                }\n            }\n        }\n    }\n}","dependentResponseJsonData":{"id":"<deploymentid>"}},{"testStepId":162308,"stepType":"API","stepNumber":4,"timeout":600,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Check if application is available","testUrl":"<replaceable.baseurl>/amc/adam/api/organizations/<replaceable.orgid>/environments/<replaceable.envid>/deployments/<deploymentid>","expectedResponseCode":200,"section":"core","tracing":"REUSE","conditionAction":"NONE","httpMethod":"GET","headers":{"Authorization":"bearer <TOKEN>"},"dependentResponseJsonData":{"name":"<APPNAME>"},"expectedResponseJsonData":{"status":"APPLIED"}},{"testStepId":162309,"stepType":"API","stepNumber":5,"timeout":60,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Send Request to deployed mule","testUrl":"https://<replaceable.externalip>/<APPNAME>/hellomule","expectedResponseCode":200,"section":"core","tracing":"REUSE","conditionAction":"NONE","httpMethod":"GET","headers":{"Host":"<replaceable.domainname>"}},{"testStepId":162310,"stepType":"API","stepNumber":6,"timeout":60,"softFailureEnabled":false,"retryOnFailure":false,"retryTest":false,"description":"Upgrade runtime version","testUrl":"<replaceable.baseurl>/amc/adam/api/organizations/<replaceable.orgid>/environments/<replaceable.envid>/deployments/<deploymentid>","expectedResponseCode":200,"section":"core","tracing":"REUSE","conditionAction":"NONE","httpMethod":"PATCH","headers":{"Authorization":"bearer <TOKEN>"},"postContent":"{\n    \"target\": {\n        \"deploymentSettings\": {\n            \"runtimeVersion\": \"<replaceable.nextruntimeversion>\"\n        }\n    }\n}","kaijuMTLS":false},{"testStepId":162314,"stepType":"API","stepNumber":7,"timeout":600,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Check if application is re-deployed","testUrl":"<replaceable.baseurl>/amc/adam/api/organizations/<replaceable.orgid>/environments/<replaceable.envid>/deployments/<deploymentid>","expectedResponseCode":200,"section":"core","tracing":"NONE","conditionAction":"NONE","httpMethod":"GET","headers":{"Authorization":"bearer <TOKEN>"}},{"testStepId":162315,"stepType":"API","stepNumber":8,"timeout":60,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Send Request to deployed mule","testUrl":"https://<replaceable.externalip>/<APPNAME>/hellomule","expectedResponseCode":200,"section":"core","tracing":"NONE","conditionAction":"NONE","httpMethod":"GET","headers":{"Host":"<replaceable.domainname>"}},{"testStepId":162316,"stepType":"API","stepNumber":9,"timeout":60,"softFailureEnabled":false,"retryOnFailure":true,"retryTest":false,"description":"Delete Mule","testUrl":"<replaceable.baseurl>/amc/adam/api/organizations/<replaceable.orgid>/environments/<replaceable.envid>/deployments/<deploymentid>","expectedResponseCode":204,"section":"finalization","tracing":"NONE","conditionAction":"NONE","httpMethod":"DELETE","headers":{"Authorization":"bearer <TOKEN>"}}],"testCaseId":87016,"name":"rtf-upgrade-mule-prod","revision":18,"description":"rtf-upgrade-mule-prod","testCaseEnabled":true,"prometheusEnabled":false,"frequency":900,"timeout":900,"dependentTestSteps":true,"tags":{"targetname":"<replaceable.targetname>","metricName":"deploy_mule_app_to_rtf","service":"RTF","runtimeversion":"<replaceable.runtimeversion>","region":"<replaceable.anypointhost>"},"captureSession":false,"agents":[{"owner":{"teamName":"Kaiju All Teams","ownerId":163,"email":"kaiju@salesforce.com"},"agentId":43,"agentName":"Heroku Sydney Agent","agentType":"heroku-syd","location":"SYD","agentApiEndpoint":"https://kaiju.data.sfdc.net/synthetics/api/agents","agentEnabled":true,"ipRange":"13.238.81.165, 13.238.131.20, 13.237.246.34, 13.210.28.44","distributeRuns":false,"shared":true,"createdTime":"2018-10-22T19:29:02.232+00:00","updatedTime":"2018-10-22T19:29:02.232+00:00"}],"replaceableData":{"createdTime":"2024-04-23T22:07:06.437+00:00","createdBy":"daniel.qu","updatedTime":"2024-04-23T22:07:06.440+00:00","updatedBy":"daniel.qu","owner":{"teamName":"MS Runtime Fabric","ownerId":3109,"email":"runtime-fabric-team@mulesoft.com"},"replaceableId":10531,"revision":1,"name":"rtf-deploy-mule-replaceable-prod","description":"rtf-deploy-mule-replaceable-prod","shared":false,"source":"KAIJU","fields":["<key>","<username>","<orgid>","<envid>","<envname>","<targetid>","<targetname>","<domainname>","<urlprotocol>","<urlappendix>","<externalip>","<baseurl>","<appname>","<appid>","<runtimeversion>","<nextruntimeversion>","<clusterprovider>","<anypointhost>","<rtftype>","<javaversion>"],"type":"UI"},"statefulHttpClient":false,"distributeReplaceableRuns":false,"adHocEnabled":false,"secret":{"createdTime":"2024-04-03T19:04:39.400+00:00","createdBy":"daniel.qu","updatedTime":"2024-04-03T19:04:39.401+00:00","updatedBy":"daniel.qu","secretId":9030,"revision":1,"owner":{"teamName":"MS Runtime Fabric","ownerId":3109,"email":"runtime-fabric-team@mulesoft.com"},"name":"rtf-deploy-mule-cred","description":"rtf-deploy-mule-cred","type":"UI","secretKeys":["password"]},"numSteps":9,"updatedDateTime":"2024-04-24T00:07:55.813Z","createdDateTime":"2024-04-23T19:19:28.522Z","frequencyInMin":15,"testType":"API","replaceable":"rtf-deploy-mule-replaceable-prod (<key> - 20 values)","secretStr":"rtf-deploy-mule-cred (9030)","teamName":"MS Runtime Fabric","tip":"","tipIconName":"standard:task2","tipObject":{"tip":"","icon":"standard:task2","score":0,"locationCount":1,"distributeRuns":false,"uselessRetry":[3,6],"retrySteps":[0,1,3,4,6,7,8],"retryTest":[],"useSection":[0,8],"useTracer":[0,1,2,3,4,5],"httpTimeoutUnset":[0,1,2,3,4,5,6,7,8],"warning":["notEnoughTimeForAllSteps","moreLocationToReduceNoise","setHTTPTimeout","retryDontHaveEnoughTimeOnSomeSteps"],"help":[]},"agentName":"Heroku Sydney Agent"}